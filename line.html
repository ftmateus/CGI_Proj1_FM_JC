<!DOCTYPE html>
<html>
<head>
<script id="vertex-shader-line" type="x-shader/x-vertex">
attribute vec4 vPosition;
varying float opacity;

void main(){
    gl_PointSize = 10.0;
    gl_Position = vPosition;
    opacity = 0.0;
    
}
</script>
<script id="vertex-shader-particles" type="x-shader/x-vertex">

    attribute vec2 startPos;
    attribute vec2 speed;
    attribute vec2 exploSpeed;
    attribute float time;
    uniform float global_time;
    attribute float firstExploTime;
    varying float opacity;

   void moveExplosionParticle(float timeTemp)
   {
        float timeTemp2 = timeTemp -(firstExploTime);
        gl_Position.x = (startPos.x + speed.x * firstExploTime) + exploSpeed.x * timeTemp2;
        gl_Position.y = (startPos.y + speed.y * firstExploTime - 0.5 * 10.0 * firstExploTime * firstExploTime) + exploSpeed.y * timeTemp2 - 0.5 * 5.0 * timeTemp2 * timeTemp2;
        gl_Position.z = 0.0;
        gl_Position.w = 1.0;
        opacity -= 0.1;
   }

   void moveRocketParticle(float timeTemp)
   {
        gl_Position.x = startPos.x + speed.x * timeTemp;
            gl_Position.y = startPos.y + speed.y * timeTemp - 0.5 * 10.0 * timeTemp * timeTemp;
            gl_Position.z = 0.0;
            gl_Position.w = 1.0;
   }
    
    void main(){
        float timeTemp = global_time - time;
        gl_PointSize = 5.0;
        
        if( timeTemp >= firstExploTime)
            moveExplosionParticle(timeTemp);
        else
            moveRocketParticle(timeTemp);
    }
    </script>

<script id="fragment-shader" type="x-shader/x-fragment">
precision mediump float;
varying vec4 vColor;
varying float opacity;
void main() {
    vec2 circCoord = 2.0 * gl_PointCoord - 1.0;
    if (dot(circCoord, circCoord) > 1.0)
    {
        discard; //manda o pixel para fora
    }
    gl_FragColor = vec4(1,1,1,0.5);
}
</script>
<script type="text/javascript" src="../Common/webgl-utils.js"></script>
<script type="text/javascript" src="../Common/initShaders.js"></script>
<script type="text/javascript" src="../Common/MV.js"></script>
<script type="text/javascript" src="line.js"></script>
</head>
<body>
    <title>Fireworks CGI</title>
    <canvas id="gl-canvas" width="512" height="512">
        Oops... your browser doesn't support the HTML5 canvas element"
    </canvas>
    <p><span id = "numParticles"></span> particles</p>
</body>
</html>